.page-shell {
  max-width: 88rem;
  margin: 0 auto;
  padding: var(--space-5) var(--space-4) var(--space-7);
}

.layout {
  display: grid;
  gap: var(--space-4);
  grid-template-columns: minmax(15rem, 19rem) minmax(0, 1fr);
  align-items: start;
}

.content-column {
  display: grid;
  gap: var(--space-4);
}

.section-stage {
  display: grid;
  grid-template-columns: minmax(0, 1fr);
  gap: var(--space-4);
  border: 1.6px solid color-mix(in srgb, var(--surface-border) 85%, #ffffff 15%);
  background:
    linear-gradient(132deg, rgb(255 255 255 / 96%) 0%, rgb(233 246 249 / 90%) 50%, rgb(233 248 243 / 88%) 100%);
}

.section-stage__meta {
  display: flex;
  align-items: end;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: var(--space-3);
}

.section-stage__eyebrow {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.18em;
  font-size: 0.7rem;
  color: var(--text-muted);
  font-weight: var(--weight-strong);
}

.section-stage__title {
  margin: 0;
  font-size: clamp(1.2rem, 1.6vw, 1.55rem);
  line-height: 1.08;
  max-width: 42ch;
}

.section-stepper {
  list-style: none;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(10.5rem, 1fr));
  gap: 0.55rem;
  margin: 0;
  padding: 0;
}

.section-stepper__item {
  margin: 0;
}

.section-stepper__button {
  width: 100%;
  border: 1.4px solid color-mix(in srgb, var(--surface-border) 72%, #ffffff 28%);
  border-radius: var(--radius-md);
  background: rgb(255 255 255 / 88%);
  padding: 0.58rem 0.68rem;
  display: grid;
  gap: 0.36rem;
  text-align: left;
  cursor: pointer;
  transition: transform var(--motion-base), box-shadow var(--motion-base), border-color var(--motion-base), background var(--motion-base);
}

.section-stepper__button:hover {
  transform: translateY(-1px);
  border-color: color-mix(in srgb, var(--accent) 50%, #ffffff 50%);
}

.section-stepper__button[aria-current="step"] {
  border-color: var(--accent);
  box-shadow: 0 10px 24px rgb(13 76 65 / 18%);
  background: linear-gradient(145deg, #ffffff 0%, color-mix(in srgb, var(--accent-soft) 36%, #ffffff 64%) 100%);
}

.section-stepper__button.is-complete {
  border-color: color-mix(in srgb, var(--success-strong) 45%, #ffffff 55%);
  background: linear-gradient(145deg, #ffffff 0%, color-mix(in srgb, var(--success-soft) 58%, #ffffff 42%) 100%);
}

.section-stepper__badge {
  width: 1.4rem;
  height: 1.4rem;
  border-radius: 999px;
  display: inline-grid;
  place-items: center;
  font-size: 0.72rem;
  font-weight: 700;
  color: var(--accent-strong);
  background: color-mix(in srgb, var(--accent-soft) 72%, #ffffff 28%);
}

.section-stepper__label {
  display: flex;
  align-items: center;
  gap: 0.45rem;
  font-weight: var(--weight-strong);
  color: var(--text-strong);
}

.section-stepper__icon-chip {
  min-width: 1.72rem;
  height: 1.72rem;
  border-radius: 0.58rem;
  display: inline-grid;
  place-items: center;
  font-size: 0.62rem;
  letter-spacing: 0.04em;
  color: var(--accent-strong);
  background: color-mix(in srgb, var(--accent-soft) 66%, #ffffff 34%);
  border: 1px solid color-mix(in srgb, var(--accent) 30%, #ffffff 70%);
}

.section-stepper__state {
  font-size: 0.72rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.06em;
  font-weight: 700;
}

.section-stage__actions {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
}

.section-stage .button:disabled {
  cursor: not-allowed;
  opacity: 0.55;
  transform: none;
  box-shadow: none;
}

.card {
  background: linear-gradient(160deg, rgb(255 255 255 / 95%) 0%, rgb(255 255 255 / 80%) 100%);
  border: 1.5px solid var(--surface-border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-sm);
  padding: 1.15rem 1.25rem;
  backdrop-filter: blur(9px);
}

.unit-header {
  position: relative;
  overflow: hidden;
  isolation: isolate;
  display: grid;
  gap: 0.72rem;
  background:
    linear-gradient(136deg, rgb(255 255 255 / 95%) 0%, rgb(233 246 250 / 88%) 55%, rgb(230 248 242 / 91%) 100%);
  box-shadow: var(--shadow-md);
  border-width: 1.6px;
}

.unit-header::before {
  content: "";
  position: absolute;
  width: 20rem;
  height: 20rem;
  top: -10rem;
  right: -7rem;
  border-radius: 999px;
  background: radial-gradient(circle, rgb(31 122 106 / 24%) 0%, rgb(31 122 106 / 0%) 66%);
  z-index: -1;
}

.unit-header::after {
  content: "";
  position: absolute;
  inset: auto auto -5.25rem -3.5rem;
  width: 16rem;
  height: 11.5rem;
  border-radius: 65% 35% 55% 45% / 45% 60% 40% 55%;
  background: linear-gradient(125deg, rgb(47 76 124 / 16%) 0%, rgb(47 76 124 / 0%) 80%);
  z-index: -1;
}

.unit-header__eyebrow {
  margin: 0;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--text-muted);
  font-weight: var(--weight-strong);
  font-size: 0.74rem;
}

.unit-header__title {
  margin: 0;
  font-size: clamp(1.82rem, 3vw, 2.95rem);
  line-height: 1.04;
}

@supports ((-webkit-background-clip: text) or (background-clip: text)) {
  .unit-header__title {
    background: linear-gradient(102deg, #1a2f49 0%, #145547 62%, #1f7a6a 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
  }
}

.unit-header__subtitle {
  margin: 0;
  max-width: 58ch;
  color: var(--text-muted);
  font-size: 0.98rem;
}

.unit-header__meta {
  display: flex;
  gap: 0.62rem;
  align-items: center;
  flex-wrap: wrap;
}

.pill {
  display: inline-flex;
  align-items: center;
  border-radius: 999px;
  padding: 0.2rem 0.65rem;
  border: 1px solid color-mix(in srgb, var(--accent) 24%, #ffffff 76%);
  color: var(--accent-strong);
  background: color-mix(in srgb, var(--accent-soft) 65%, #ffffff 35%);
  font-size: 0.82rem;
  font-weight: var(--weight-strong);
}

.button {
  border: 2px solid transparent;
  border-radius: 0.95rem;
  padding: 0.48rem 0.88rem;
  cursor: pointer;
  font-weight: var(--weight-strong);
  font-size: 0.92rem;
  text-decoration: none;
  display: inline-flex;
  justify-content: center;
  align-items: center;
  touch-action: manipulation;
  -webkit-tap-highlight-color: rgb(21 104 90 / 20%);
  transition: transform var(--motion-base), box-shadow var(--motion-base), border-color var(--motion-base), background-color var(--motion-base), color var(--motion-base);
}

.button:hover {
  transform: translateY(-1px);
}

.button:active {
  transform: translateY(1px);
}

.button--primary {
  background: linear-gradient(132deg, var(--accent) 0%, var(--accent-strong) 100%);
  border-color: #0d4c41;
  color: #ffffff;
  box-shadow: 0 4px 0 0 #0b3d34, 0 12px 24px rgb(12 93 79 / 22%);
}

.button--primary:hover {
  box-shadow: 0 5px 0 0 #0b3d34, 0 16px 28px rgb(12 93 79 / 28%);
}

.button--primary[aria-pressed="true"] {
  background: linear-gradient(130deg, #2f9e63 0%, #237a4d 100%);
  border-color: #1b5f3b;
  box-shadow: 0 4px 0 0 #154e31, 0 12px 24px rgb(24 96 56 / 24%);
}

.button--ghost {
  border-color: color-mix(in srgb, var(--surface-border) 88%, #ffffff 12%);
  color: var(--text-strong);
  background: rgb(255 255 255 / 94%);
  box-shadow: 0 3px 0 0 color-mix(in srgb, var(--surface-border) 90%, #ffffff 10%);
}

.button--ghost:hover {
  border-color: color-mix(in srgb, var(--accent) 45%, #ffffff 55%);
}

.section-header {
  margin: 0 0 var(--space-2);
  font-size: clamp(1.22rem, 1.85vw, 1.52rem);
}

.section-subheading {
  margin: var(--space-3) 0 var(--space-2);
  font-size: 1.08rem;
}

.mission-brief {
  gap: var(--space-2);
}

.mission-brief__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  flex-wrap: wrap;
}

.mission-brief__summary {
  margin: 0;
  color: var(--text-muted);
  font-size: 0.9rem;
}

.mission-brief__toggle {
  padding: 0.34rem 0.62rem;
  font-size: 0.82rem;
  border-radius: 0.72rem;
}

.mission-brief [hidden] {
  display: none !important;
}

.objectives {
  display: grid;
  gap: var(--space-2);
  background:
    linear-gradient(140deg, rgb(255 255 255 / 92%) 0%, rgb(236 248 252 / 84%) 100%);
}

.objectives__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: var(--space-2);
}

.objectives__item {
  position: relative;
  margin: 0;
  padding-left: 1.18rem;
  font-size: 0.92rem;
  line-height: 1.42;
}

.objectives__item::before {
  content: "";
  position: absolute;
  left: 0;
  top: 0.44rem;
  width: 0.5rem;
  height: 0.5rem;
  border-radius: 0.2rem;
  background: linear-gradient(135deg, var(--accent) 0%, var(--accent-strong) 100%);
}

.sticky-nav {
  position: sticky;
  top: var(--space-4);
  background:
    linear-gradient(180deg, rgb(255 255 255 / 92%) 0%, rgb(244 250 252 / 86%) 100%);
  border: 1.35px solid color-mix(in srgb, var(--surface-border) 75%, #ffffff 25%);
}

.sticky-nav__list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: grid;
  gap: 0.38rem;
}

.sticky-nav__item {
  margin: 0;
}

.sticky-nav__item--child {
  padding-left: 0.92rem;
}

.sticky-nav__link {
  display: block;
  border-radius: var(--radius-sm);
  padding: 0.45rem 0.58rem;
  color: color-mix(in srgb, var(--text-muted) 84%, #ffffff 16%);
  text-decoration: none;
  transition: color var(--motion-base), background var(--motion-base), transform var(--motion-fast);
}

.sticky-nav__link:hover {
  color: var(--text-strong);
  background: var(--surface-soft);
  transform: translateX(1px);
}

.sticky-nav__link.is-active {
  color: var(--accent-strong);
  background: color-mix(in srgb, var(--accent-soft) 76%, #ffffff 24%);
  font-weight: var(--weight-strong);
}

.learning-dashboard {
  display: grid;
  gap: var(--space-3);
  background:
    linear-gradient(133deg, rgb(255 255 255 / 94%) 0%, rgb(232 245 250 / 86%) 56%, rgb(231 247 241 / 84%) 100%);
}

.learning-dashboard.is-complete {
  border-color: #62b68f;
  box-shadow: 0 26px 62px rgb(18 85 71 / 17%);
}

.learning-dashboard__header {
  display: flex;
  justify-content: space-between;
  align-items: end;
  gap: var(--space-3);
  flex-wrap: wrap;
}

.learning-dashboard__summary {
  margin: 0;
  font-weight: var(--weight-strong);
  color: var(--accent-strong);
  font-size: 0.96rem;
}

.learning-dashboard__bar {
  position: relative;
  height: 0.72rem;
  border-radius: 999px;
  overflow: hidden;
  background: color-mix(in srgb, var(--accent-soft) 45%, #ffffff 55%);
  border: 1px solid color-mix(in srgb, var(--surface-border) 70%, #ffffff 30%);
}

.learning-dashboard__fill {
  width: 0;
  height: 100%;
  border-radius: inherit;
  background: linear-gradient(90deg, #145547 0%, #1f7a6a 45%, #4fae93 100%);
  box-shadow: 0 0 16px rgb(31 122 106 / 45%);
  transition: width var(--motion-slow);
}

.learning-dashboard__grid {
  display: grid;
  gap: 0.62rem;
  grid-template-columns: repeat(auto-fit, minmax(11.5rem, 1fr));
}

.dashboard-metric {
  border: 1px solid color-mix(in srgb, var(--surface-border) 78%, #ffffff 22%);
  border-radius: var(--radius-md);
  background: rgb(255 255 255 / 82%);
  padding: 0.55rem 0.62rem;
  display: grid;
  gap: 0.2rem;
}

.dashboard-metric__label {
  margin: 0;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.67rem;
  color: var(--text-muted);
  font-weight: 700;
}

.dashboard-metric__value {
  margin: 0;
  color: var(--text-strong);
  font-family: var(--font-display);
  font-size: 1rem;
  font-variant-numeric: tabular-nums;
}

.unit-section {
  scroll-margin-top: 4rem;
  border-width: 1.4px;
  position: relative;
  background:
    linear-gradient(165deg, rgb(255 255 255 / 90%) 0%, rgb(248 252 255 / 80%) 100%);
}

.unit-section__header {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  margin-bottom: var(--space-2);
}

.unit-section__chip {
  width: 2.1rem;
  height: 2.1rem;
  border-radius: 0.72rem;
  display: inline-grid;
  place-items: center;
  font-size: 0.68rem;
  letter-spacing: 0.05em;
  font-weight: var(--weight-strong);
  border: 1px solid color-mix(in srgb, var(--accent) 30%, #ffffff 70%);
  background: color-mix(in srgb, var(--accent-soft) 72%, #ffffff 28%);
  color: var(--accent-strong);
}

.unit-section__heading-wrap {
  min-width: 0;
}

.unit-section__kicker {
  margin: 0 0 0.2rem;
  font-size: 0.69rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--text-muted);
  font-weight: 700;
}

.unit-section[data-section-tone="tone-1"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-1-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-1-bg) 70%, #ffffff 30%);
  color: var(--tone-1-accent);
}

.unit-section[data-section-tone="tone-2"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-2-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-2-bg) 70%, #ffffff 30%);
  color: var(--tone-2-accent);
}

.unit-section[data-section-tone="tone-3"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-3-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-3-bg) 70%, #ffffff 30%);
  color: var(--tone-3-accent);
}

.unit-section[data-section-tone="tone-4"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-4-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-4-bg) 70%, #ffffff 30%);
  color: var(--tone-4-accent);
}

.unit-section[data-section-tone="tone-5"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-5-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-5-bg) 70%, #ffffff 30%);
  color: var(--tone-5-accent);
}

.unit-section[data-section-tone="tone-6"] .unit-section__chip {
  border-color: color-mix(in srgb, var(--tone-6-accent) 38%, #ffffff 62%);
  background: color-mix(in srgb, var(--tone-6-bg) 70%, #ffffff 30%);
  color: var(--tone-6-accent);
}

body.js-paged .content-column {
  gap: var(--space-4);
}

body.js-paged .content-column > [data-section][hidden] {
  display: none !important;
}

body.js-paged .content-column > [data-section].is-active-section {
  animation: section-stage-enter 360ms ease;
}

body.js-paged .content-column > [data-section-role="aux"] {
  display: grid;
}

.unit-section[data-section-tone="tone-1"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-1-bg) 68%, #ffffff 32%) 0%, #ffffff 100%);
}

.unit-section[data-section-tone="tone-2"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-2-bg) 70%, #ffffff 30%) 0%, #ffffff 100%);
}

.unit-section[data-section-tone="tone-3"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-3-bg) 69%, #ffffff 31%) 0%, #ffffff 100%);
}

.unit-section[data-section-tone="tone-4"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-4-bg) 67%, #ffffff 33%) 0%, #ffffff 100%);
}

.unit-section[data-section-tone="tone-5"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-5-bg) 67%, #ffffff 33%) 0%, #ffffff 100%);
}

.unit-section[data-section-tone="tone-6"] {
  background: linear-gradient(160deg, color-mix(in srgb, var(--tone-6-bg) 68%, #ffffff 32%) 0%, #ffffff 100%);
}

.unit-section.is-complete-section {
  border-color: color-mix(in srgb, var(--success-strong) 45%, #ffffff 55%);
  box-shadow: 0 20px 48px rgb(31 125 86 / 18%);
}

.unit-section::before {
  content: "";
  position: absolute;
  left: 0;
  top: 1.2rem;
  bottom: 1.2rem;
  width: 0.32rem;
  border-radius: 999px;
  background: linear-gradient(180deg, var(--accent) 0%, rgb(17 122 103 / 20%) 100%);
  opacity: 0.8;
}

.unit-section[data-section-tone="tone-1"]::before {
  background: linear-gradient(180deg, var(--tone-1-accent) 0%, color-mix(in srgb, var(--tone-1-accent) 25%, #ffffff 75%) 100%);
}

.unit-section[data-section-tone="tone-2"]::before {
  background: linear-gradient(180deg, var(--tone-2-accent) 0%, color-mix(in srgb, var(--tone-2-accent) 25%, #ffffff 75%) 100%);
}

.unit-section[data-section-tone="tone-3"]::before {
  background: linear-gradient(180deg, var(--tone-3-accent) 0%, color-mix(in srgb, var(--tone-3-accent) 25%, #ffffff 75%) 100%);
}

.unit-section[data-section-tone="tone-4"]::before {
  background: linear-gradient(180deg, var(--tone-4-accent) 0%, color-mix(in srgb, var(--tone-4-accent) 25%, #ffffff 75%) 100%);
}

.unit-section[data-section-tone="tone-5"]::before {
  background: linear-gradient(180deg, var(--tone-5-accent) 0%, color-mix(in srgb, var(--tone-5-accent) 25%, #ffffff 75%) 100%);
}

.unit-section[data-section-tone="tone-6"]::before {
  background: linear-gradient(180deg, var(--tone-6-accent) 0%, color-mix(in srgb, var(--tone-6-accent) 25%, #ffffff 75%) 100%);
}

.content-block > :last-child {
  margin-bottom: 0;
}

.markdown > :last-child {
  margin-bottom: 0;
}

.markdown h4,
.markdown h5,
.markdown h6 {
  margin-bottom: var(--space-2);
}

.callout {
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  border-left-width: 0.35rem;
  padding: var(--space-4);
  margin-bottom: var(--space-4);
  box-shadow: inset 0 1px 0 rgb(255 255 255 / 58%);
}

.callout--info {
  background: var(--info-soft);
  border-color: #a8d6f0;
  color: var(--info-strong);
}

.callout--warning {
  background: var(--warning-soft);
  border-color: #f3c38d;
  color: var(--warning-strong);
}

.callout--example {
  background: var(--example-soft);
  border-color: #d4c3f7;
  color: var(--example-strong);
}

.callout__body > :last-child {
  margin-bottom: 0;
}

.accordion {
  display: grid;
  gap: var(--space-3);
  background: color-mix(in srgb, var(--surface-soft) 50%, #ffffff 50%);
}

.accordion__item {
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  overflow: hidden;
  background: rgb(255 255 255 / 68%);
}

.accordion__trigger {
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-3);
  border: none;
  background: rgb(255 255 255 / 66%);
  color: var(--text-strong);
  text-align: left;
  font-weight: 700;
  padding: var(--space-3) var(--space-4);
  cursor: pointer;
}

.accordion__trigger::after {
  content: "+";
  font-size: 1.18rem;
  line-height: 1;
  color: var(--accent-strong);
}

.accordion__trigger.is-open::after {
  content: "-";
}

.accordion__panel {
  border-top: 1px solid var(--surface-border);
  background: rgb(255 255 255 / 56%);
}

.accordion__content {
  padding: var(--space-3) var(--space-4);
}

.workbook {
  display: grid;
  gap: var(--space-4);
  background:
    linear-gradient(150deg, rgb(255 255 255 / 95%) 0%, rgb(232 245 252 / 86%) 50%, rgb(235 250 244 / 82%) 100%);
}

.workbook.is-complete {
  border-color: #64b88f;
  box-shadow: 0 22px 52px rgb(13 82 64 / 16%);
}

.workbook__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  flex-wrap: wrap;
}

.workbook__title {
  margin: 0;
  font-size: 1.22rem;
}

.workbook__progress {
  margin: 0;
  border-radius: 999px;
  padding: 0.2rem 0.68rem;
  background: color-mix(in srgb, var(--accent-soft) 70%, #ffffff 30%);
  color: var(--accent-strong);
  font-weight: 700;
  font-size: 0.84rem;
}

.workbook__description {
  color: var(--text-muted);
}

.workbook__description > :last-child {
  margin-bottom: 0;
}

.workbook__grid {
  display: grid;
  gap: var(--space-3);
  grid-template-columns: repeat(auto-fit, minmax(16rem, 1fr));
}

.workbook__field {
  display: grid;
  gap: var(--space-2);
  margin: 0;
  padding: var(--space-3);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  background: rgb(255 255 255 / 82%);
}

.workbook__field--options {
  gap: var(--space-3);
}

.workbook__label {
  font-weight: 700;
  color: var(--text-strong);
}

.workbook__input,
.workbook__textarea {
  width: 100%;
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  background: rgb(255 255 255 / 92%);
  color: var(--text-body);
  padding: 0.58rem 0.68rem;
  font: inherit;
}

.workbook__textarea {
  min-height: 8rem;
  resize: vertical;
}

.workbook__input:focus,
.workbook__textarea:focus {
  border-color: var(--accent);
  outline: 2px solid color-mix(in srgb, var(--accent) 33%, #ffffff 67%);
  outline-offset: 1px;
}

.workbook__options {
  display: grid;
  gap: 0.62rem;
}

.workbook__choice {
  display: flex;
  align-items: center;
  gap: 0.58rem;
  color: var(--text-body);
}

.workbook__choice input {
  width: 1rem;
  height: 1rem;
  accent-color: var(--accent);
}

.scenario,
.ranking,
.decision-tree {
  display: grid;
  gap: var(--space-4);
  background:
    linear-gradient(145deg, rgb(255 255 255 / 96%) 0%, rgb(236 247 254 / 86%) 48%, rgb(238 251 246 / 82%) 100%);
}

.scenario.is-complete,
.ranking.is-complete,
.decision-tree.is-complete {
  border-color: #64b88f;
  box-shadow: 0 22px 52px rgb(13 82 64 / 16%);
}

.scenario__header,
.ranking__header,
.decision-tree__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  flex-wrap: wrap;
}

.scenario__title,
.ranking__title,
.decision-tree__title {
  margin: 0;
  font-size: 1.22rem;
}

.scenario__progress,
.ranking__progress,
.decision-tree__progress {
  margin: 0;
  border-radius: 999px;
  padding: 0.2rem 0.68rem;
  background: color-mix(in srgb, var(--accent-soft) 70%, #ffffff 30%);
  color: var(--accent-strong);
  font-weight: 700;
  font-size: 0.84rem;
}

.scenario__description,
.ranking__description,
.decision-tree__description {
  color: var(--text-muted);
}

.scenario__description > :last-child,
.ranking__description > :last-child,
.decision-tree__description > :last-child {
  margin-bottom: 0;
}

.scenario__grid,
.ranking__grid {
  display: grid;
  gap: var(--space-3);
}

.scenario__prompt,
.ranking__row,
.decision-tree__node {
  display: grid;
  gap: var(--space-2);
  margin: 0;
  padding: var(--space-3);
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  background: rgb(255 255 255 / 82%);
}

.scenario__question,
.ranking__label,
.decision-tree__prompt {
  margin: 0;
  font-weight: 700;
  color: var(--text-strong);
}

.scenario__choices {
  display: grid;
  gap: 0.62rem;
}

.scenario__choice {
  display: flex;
  align-items: center;
  gap: 0.58rem;
  color: var(--text-body);
}

.scenario__choice input {
  width: 1rem;
  height: 1rem;
  accent-color: var(--accent);
}

.scenario__outcome {
  margin-top: var(--space-1);
}

.scenario__outcome-item {
  border-left: 0.24rem solid color-mix(in srgb, var(--accent) 80%, #ffffff 20%);
  padding-left: var(--space-2);
  color: var(--text-muted);
}

.ranking__select {
  width: 100%;
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-sm);
  background: rgb(255 255 255 / 92%);
  color: var(--text-body);
  padding: 0.58rem 0.68rem;
  font: inherit;
}

.ranking__select:focus {
  border-color: var(--accent);
  outline: 2px solid color-mix(in srgb, var(--accent) 33%, #ffffff 67%);
  outline-offset: 1px;
}

.decision-tree__canvas {
  display: grid;
  gap: var(--space-3);
}

.decision-tree__choices {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
}

.decision-tree__choice {
  border: 1px solid var(--surface-border);
  border-radius: 999px;
  padding: 0.45rem 0.82rem;
  background: rgb(255 255 255 / 92%);
  color: var(--text-body);
  cursor: pointer;
  font-weight: 700;
}

.decision-tree__choice:hover {
  border-color: var(--accent);
}

.decision-tree__end {
  margin: 0;
  color: var(--accent-strong);
  font-weight: 700;
}

.decision-tree__controls {
  display: flex;
  justify-content: flex-end;
}

.resource-grid {
  display: grid;
  gap: var(--space-3);
  grid-template-columns: repeat(auto-fit, minmax(14rem, 1fr));
}

.resources {
  display: grid;
  gap: var(--space-3);
}

.resource-card {
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--space-4);
  display: grid;
  gap: var(--space-3);
  background:
    linear-gradient(145deg, rgb(255 255 255 / 90%) 0%, rgb(233 245 255 / 80%) 100%);
}

.resource-card__meta {
  text-transform: uppercase;
  letter-spacing: 0.08em;
  font-size: 0.68rem;
  color: var(--text-muted);
  font-weight: 700;
}

.resource-card__title {
  margin: 0;
  font-size: 1rem;
}

.flashcards {
  display: grid;
  gap: var(--space-4);
}

.flashcards__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-4);
  flex-wrap: wrap;
}

.flashcards__progress {
  margin: 0;
  color: var(--text-muted);
  font-weight: 700;
}

.flashcards__grid {
  display: grid;
  gap: var(--space-4);
  grid-template-columns: repeat(auto-fit, minmax(14rem, 1fr));
}

.flashcard {
  border: 1px solid var(--surface-border);
  border-radius: var(--radius-md);
  padding: var(--space-3);
  background: rgb(255 255 255 / 84%);
  display: grid;
  gap: var(--space-2);
  transition: transform var(--motion-base), box-shadow var(--motion-base), border-color var(--motion-base), background var(--motion-base);
}

.flashcard:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-sm);
}

.flashcard__inner {
  display: block;
}

.flashcard.is-reviewed {
  border-color: #7bc09e;
  background: #ecf9f1;
}

.flashcard__face {
  border: 1px solid var(--surface-border);
  background: var(--surface-soft);
  border-radius: var(--radius-sm);
  cursor: pointer;
  padding: var(--space-4);
  color: var(--text-body);
  text-align: left;
  min-height: 7.1rem;
  width: 100%;
  display: grid;
  gap: var(--space-2);
  transition: border-color var(--motion-base), transform var(--motion-base), background var(--motion-base);
}

.flashcard__face:hover {
  border-color: var(--accent);
  transform: translateY(-1px);
}

.flashcard__face--front {
  background: linear-gradient(145deg, #f7fbfe 0%, #ebf4f9 100%);
}

.flashcard__face--back {
  background: linear-gradient(145deg, #edf8f3 0%, #e3f1ea 100%);
}

.flashcard__label {
  font-size: 0.74rem;
  text-transform: uppercase;
  letter-spacing: 0.07em;
  color: var(--text-muted);
  font-weight: 700;
}

.flashcard__tag {
  margin: 0;
  color: var(--text-muted);
  font-size: 0.8rem;
}

.completion-state {
  margin-left: var(--space-2);
  color: var(--success-strong);
  font-weight: var(--weight-strong);
  font-size: 0.82rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.section-stepper__button.is-in-progress .section-stepper__state {
  color: var(--accent-strong);
}

.section-stepper__button.is-complete .section-stepper__state {
  color: var(--success-strong);
}

.celebration-burst {
  position: absolute;
  pointer-events: none;
  inset: auto 0 0 auto;
  width: 8rem;
  height: 8rem;
  z-index: 5;
  animation: celebration-fade 720ms ease forwards;
}

.celebration-burst__dot {
  position: absolute;
  width: 0.42rem;
  height: 0.42rem;
  border-radius: 999px;
  background: linear-gradient(135deg, #2f9e63 0%, #45c487 100%);
  opacity: 0.95;
  transform: translate(var(--dx), var(--dy));
  animation: celebration-pop 620ms cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
}

.scroll-progress {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 7px;
  background: rgb(255 255 255 / 74%);
  z-index: 999;
  border-bottom: 1px solid rgb(19 34 58 / 8%);
}

.scroll-progress__bar {
  width: 0;
  height: 100%;
  background: linear-gradient(90deg, #145547 0%, #1f7a6a 50%, #4fae93 100%);
  box-shadow: 0 0 14px rgb(31 122 106 / 45%);
  transition: width 120ms linear;
}

@keyframes section-stage-enter {
  from {
    opacity: 0;
    transform: translateY(14px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes celebration-fade {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

@keyframes celebration-pop {
  from {
    transform: translate(0, 0) scale(0.25);
  }
  to {
    transform: translate(var(--dx), var(--dy)) scale(1);
  }
}

.js-animate .unit-section,
.js-animate .objectives,
.js-animate .learning-dashboard,
.js-animate .section-stage,
.js-animate .resources,
.js-animate .flashcards,
.js-animate .workbook,
.js-animate .scenario,
.js-animate .ranking,
.js-animate .decision-tree {
  opacity: 0;
  transform: translateY(16px);
  transition: opacity var(--motion-slow), transform var(--motion-slow);
}

.js-animate .is-visible {
  opacity: 1;
  transform: translateY(0);
}

@media (max-width: 920px) {
  .page-shell {
    padding: var(--space-4) var(--space-3) var(--space-6);
  }

  .layout {
    grid-template-columns: 1fr;
  }

  .sticky-nav {
    position: static;
  }

  .unit-section::before {
    width: 0.22rem;
  }

  .learning-dashboard__grid {
    grid-template-columns: repeat(auto-fit, minmax(9.5rem, 1fr));
  }

  .section-stage {
    align-items: start;
  }

  .section-stepper {
    grid-template-columns: repeat(auto-fit, minmax(9rem, 1fr));
  }
}

@media (max-width: 560px) {
  .card {
    padding: var(--space-4);
    border-radius: var(--radius-lg);
  }

  .unit-header__title {
    font-size: clamp(1.75rem, 10vw, 2.2rem);
  }

  .section-stage__actions {
    width: 100%;
  }

  .section-stage__actions .button {
    flex: 1;
  }

  .flashcards__grid {
    grid-template-columns: 1fr;
  }
}

@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }

  .button,
  .flashcard,
  .flashcard__face,
  .scroll-progress__bar,
  .js-animate .unit-section,
  .js-animate .objectives,
  .js-animate .learning-dashboard,
  .js-animate .section-stage,
  .js-animate .resources,
  .js-animate .flashcards,
  .js-animate .workbook,
  .js-animate .scenario,
  .js-animate .ranking,
  .js-animate .decision-tree {
    transition-duration: 1ms !important;
    animation-duration: 1ms !important;
  }
}
